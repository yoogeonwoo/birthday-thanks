<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>생일 감사 홈페이지</title>
  <style>
    @font-face{
      font-family:"GarMa";
      src:url("assets/fonts/NanumGarMaYeonGgoc.ttf") format("truetype");
      font-display:swap;
    }

    :root{
      --font: "GarMa","나눔손글씨 가람연꽃","Nanum GarMaYeonGgoc",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;

      --ink: rgba(35, 24, 12, 0.94);
      --line: rgba(92, 66, 30, 0.32);
      --shadow: rgba(0,0,0,0.30);

      --btnA: rgba(232, 196, 112, 0.98);
      --btnB: rgba(206, 168, 86, 0.98);
      --btnC: rgba(222, 184, 104, 0.98);
      --btnD: rgba(191, 150, 70, 0.98);

      --paperA: rgba(255, 252, 246, 0.97);
      --paperB: rgba(244, 234, 219, 0.97);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{ font-family:var(--font); color:var(--ink); }

    .app{
      position:relative;
      min-height:100vh;
      overflow:hidden;
    }

    .bg{
      position:absolute; inset:0;
      background:url("assets/bg.jpg") center/cover no-repeat;
      transform:scale(1.02);
      filter:saturate(0.98) contrast(0.98) brightness(0.98);
      z-index:0;
    }

    .grain{
      position:absolute; inset:0;
      pointer-events:none;
      opacity:0.14;
      background-image:
        repeating-linear-gradient(0deg, rgba(255,255,255,0.035) 0px, rgba(255,255,255,0.035) 1px, transparent 1px, transparent 3px),
        repeating-linear-gradient(90deg, rgba(0,0,0,0.03) 0px, rgba(0,0,0,0.03) 1px, transparent 1px, transparent 4px);
      mix-blend-mode:overlay;
      z-index:1;
    }

    .home{
      position:relative;
      z-index:2;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:18px;
      padding:24px;
    }

    .envelope{
      width:min(300px, 74vw);
      aspect-ratio: 4 / 3;
      position:relative;
      filter: drop-shadow(0 14px 30px rgba(0,0,0,0.22));
    }

    .env-base{
      position:absolute; inset:0;
      border-radius:16px;
      border:1px solid var(--line);
      background:
        radial-gradient(circle at 30% 25%, rgba(255,255,255,0.55), transparent 60%),
        radial-gradient(circle at 70% 75%, rgba(80,55,25,0.10), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,0.92), rgba(245,236,220,0.92));
      overflow:hidden;
    }

    .env-front{
      position:absolute; inset:0;
      border-radius:16px;
      overflow:hidden;
    }

    .env-front::before{
      content:"";
      position:absolute; inset:0;
      background:
        linear-gradient(180deg, rgba(255,255,255,0.20), rgba(0,0,0,0.02));
      opacity:0.35;
    }

    .env-left,
    .env-right{
      position:absolute;
      top:22%;
      width:62%;
      height:78%;
      background:linear-gradient(180deg, rgba(250,244,235,0.92), rgba(232,220,205,0.92));
      border:1px solid rgba(92,66,30,0.22);
    }

    .env-left{
      left:-8%;
      transform:skewX(-20deg);
      clip-path: polygon(0 0, 100% 25%, 100% 100%, 0 100%);
      border-right:none;
    }

    .env-right{
      right:-8%;
      transform:skewX(20deg);
      clip-path: polygon(0 25%, 100% 0, 100% 100%, 0 100%);
      border-left:none;
    }

    .env-bottom{
      position:absolute;
      left:0; right:0; bottom:0;
      height:58%;
      background:linear-gradient(180deg, rgba(248,241,232,0.94), rgba(230,216,198,0.94));
      border-top:1px solid rgba(92,66,30,0.22);
      clip-path: polygon(0 22%, 50% 70%, 100% 22%, 100% 100%, 0 100%);
    }

    .env-flap{
      position:absolute;
      left:0; right:0; top:0;
      height:64%;
      transform-origin: 50% 0%;
      transform: rotateX(0deg);
      background:linear-gradient(180deg, rgba(246,238,228,0.96), rgba(222,206,186,0.96));
      border:1px solid rgba(92,66,30,0.24);
      clip-path: polygon(0 0, 100% 0, 50% 82%);
      border-bottom:none;
      border-radius:16px 16px 0 0;
    }

    .actions{
      width:min(360px, 86vw);
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .btn{
      width:100%;
      padding:12px 14px;
      border-radius:999px;
      border:1px solid rgba(92,66,30,0.40);
      cursor:pointer;
      font-family:var(--font);
      font-size:18px;
      letter-spacing:0.02em;
      color:rgba(20,14,8,0.92);
      box-shadow:0 10px 20px rgba(0,0,0,0.16);
      position:relative;
      overflow:hidden;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }

    .btn::after{
      content:"";
      position:absolute; inset:-40%;
      background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.28), transparent 58%);
      opacity:0.75;
      pointer-events:none;
    }

    .btn-primary{
      background:linear-gradient(180deg, var(--btnA), var(--btnB));
    }

    .btn-secondary{
      background:linear-gradient(180deg, var(--btnC), var(--btnD));
    }

    .btn:active{
      transform: translateY(1px);
      box-shadow:0 7px 16px rgba(0,0,0,0.16);
    }

    .modal{
      position:fixed; inset:0;
      display:none;
      z-index:30;
    }
    .modal.is-open{ display:block; }

    .backdrop{
      position:absolute; inset:0;
      background:rgba(0,0,0,0.50);
    }

    .panel{
      position:relative;
      width:min(860px, 94vw);
      margin:6vh auto 0;
      border-radius:18px;
      border:1px solid var(--line);
      box-shadow:0 18px 44px var(--shadow);
      overflow:hidden;
      background:linear-gradient(180deg, var(--paperA), var(--paperB));
    }

    .paper{
      min-height:72vh;
      background:url("assets/paper.jpg") center/cover no-repeat;
    }

    .paper::before{
      content:"";
      position:absolute; inset:-10%;
      background:
        radial-gradient(circle at 25% 20%, rgba(255,255,255,0.52), transparent 60%),
        radial-gradient(circle at 70% 80%, rgba(80,55,25,0.14), transparent 62%);
      opacity:0.86;
      pointer-events:none;
    }

    .close{
      position:absolute; top:10px; right:12px;
      border:1px solid rgba(60,40,15,0.22);
      background:rgba(255,255,255,0.58);
      border-radius:10px;
      cursor:pointer;
      font-family:var(--font);
      font-size:16px;
      padding:6px 10px;
      z-index:2;
    }

    .title{
      position:relative;
      margin:18px 18px 10px;
      font-size:28px;
      z-index:1;
    }

    .content{
      position:relative;
      margin:0 18px 20px;
      font-size:18px;
      line-height:1.8;
      z-index:1;
      white-space:pre-wrap;
    }

    .card{
      padding:18px 16px 20px;
    }

    .form{
      display:flex;
      gap:10px;
      align-items:center;
      padding:0 18px 18px;
    }

    .input{
      flex:1;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(80,55,25,0.34);
      font-family:var(--font);
      font-size:18px;
      background:rgba(255,255,255,0.76);
      outline:none;
    }

    .replyFrame{
      position:relative;
      padding:18px 16px 20px;
      background:linear-gradient(180deg, rgba(255,252,246,0.98), rgba(244,234,219,0.98));
    }

    .replyDecorTape{
      position:absolute;
      width:150px; height:40px;
      top:14px; left:18px;
      transform:rotate(-7deg);
      border:1px solid rgba(120,90,40,0.22);
      background:linear-gradient(180deg, rgba(232,216,170,0.72), rgba(204,184,130,0.64));
      opacity:0.86;
      z-index:1;
      pointer-events:none;
    }

    .replyDecorStamp{
      position:absolute;
      width:74px; height:74px;
      top:14px; right:16px;
      border-radius:14px;
      border:1px dashed rgba(80,55,25,0.42);
      background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.35), rgba(120,80,30,0.14));
      z-index:1;
      pointer-events:none;
    }

    .replyDecorStamp::after{
      content:"THANKS";
      position:absolute; inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:12px;
      letter-spacing:0.12em;
      opacity:0.62;
    }

    @media (max-width:480px){
      .title{ font-size:24px; }
      .content,.btn,.input{ font-size:17px; }
      .form{ flex-direction:column; align-items:stretch; }
    }
  </style>
</head>

<body>
  <main class="app">
    <div class="bg" aria-hidden="true"></div>
    <div class="grain" aria-hidden="true"></div>

    <section class="home" aria-label="메인 화면">
      <div class="envelope" aria-hidden="true">
        <div class="env-base"></div>
        <div class="env-front">
          <div class="env-left"></div>
          <div class="env-right"></div>
          <div class="env-bottom"></div>
        </div>
        <div class="env-flap"></div>
      </div>

      <div class="actions">
        <button class="btn btn-primary" id="btnOpenLetter" type="button">편지 읽기</button>
        <button class="btn btn-secondary" id="btnOpenInbox" type="button">나에게 도착한 편지</button>
      </div>
    </section>

    <section class="modal" id="modalLetter" aria-hidden="true">
      <div class="backdrop" data-close="modalLetter"></div>
      <div class="panel paper" role="dialog" aria-modal="true" aria-label="메인 감사 편지">
        <button class="close" type="button" data-close="modalLetter" aria-label="닫기">X</button>
        <h1 class="title">생일을 축하해주신 모든 분들께.</h1>
        <div class="content">
안녕하세요. 금일 생일자 유건우입니다. 먼저 보잘것 없는 제 생일을 축하해주신 모든 분들께 진심으로 감사의 말씀 올립니다. 또 힘겨운 한 해를 열심히 걸어오시어 새 해를 맞이하신 여러분들께 존경과 축하의 박수를 드리고 싶습니다. 저 또한 항상 지지해주시고 관심을 주신 여러분들 덕분에 한 해를 그 누구보다 보람차게 마무리하고 설레는 새 해를 맞이할 수  있게 되었습니다. 제게 25년은 새로운 환경에서 새로운 사람들과의 만남의 연속이였습니다. 매일이 낮설고 힘들었지만, 여러분들 덕분에 한 해를 무사히 마무리하고 또 새 해가 밝자마자 주제에 맞지 않는 격한 생일을 축하받았습니다. 저는 이러한 여러분의 성원이 2026년, 지금의 저를 만들었다고 생각합니다. 항상 감사하는 마음을 가지고 병오년에는 받은 것보다 더 많이 배풀고 감사하는 삶을 살겠습니다. 또 한 해동안 제 말과 행동으로 인해 상처를 받았거나 불편함을 느끼셨을 분들에게는 진심 어린 사과를 드리며, 금년에는 그러한 일이 없도록 항상 주의하겠습니다. 다시 한 번 여러분의 무한한 은혜에 감사드리며, 더 나은 유건우로 보답하겠습니다. 감사합니다.

- 유건우 올림 -
        </div>
      </div>
    </section>

    <section class="modal" id="modalName" aria-hidden="true">
      <div class="backdrop" data-close="modalName"></div>
      <div class="panel card" role="dialog" aria-modal="true" aria-label="이름 입력">
        <button class="close" type="button" data-close="modalName" aria-label="닫기">X</button>
        <h2 class="title">나에게 도착한 편지</h2>
        <div class="form">
          <input id="nameInput" class="input" placeholder="이름을 입력하세요" autocomplete="off" />
          <button class="btn btn-primary" id="btnCheckName" type="button">확인하기</button>
        </div>
      </div>
    </section>

    <section class="modal" id="modalReply" aria-hidden="true">
      <div class="backdrop" data-close="modalReply"></div>
      <div class="panel" role="dialog" aria-modal="true" aria-label="개인 답장">
        <button class="close" type="button" data-close="modalReply" aria-label="닫기">X</button>
        <div class="replyFrame">
          <div class="replyDecorTape" aria-hidden="true"></div>
          <div class="replyDecorStamp" aria-hidden="true"></div>
          <h2 class="title" id="replyTitle"></h2>
          <div class="content" id="replyBody"></div>
        </div>
      </div>
    </section>
  </main>

  <script>
    const $ = (s) => document.querySelector(s);

    const modalLetter = $("#modalLetter");
    const modalName = $("#modalName");
    const modalReply = $("#modalReply");

    const btnOpenLetter = $("#btnOpenLetter");
    const btnOpenInbox = $("#btnOpenInbox");
    const btnCheckName = $("#btnCheckName");

    const nameInput = $("#nameInput");
    const replyTitle = $("#replyTitle");
    const replyBody = $("#replyBody");

    let repliesCache = null;

    const openModal = (m) => { m.classList.add("is-open"); m.setAttribute("aria-hidden","false"); };
    const closeModal = (m) => { m.classList.remove("is-open"); m.setAttribute("aria-hidden","true"); };

    document.addEventListener("click", (e) => {
      const key = e.target && e.target.dataset ? e.target.dataset.close : null;
      if (!key) return;
      if (key === "modalLetter") closeModal(modalLetter);
      if (key === "modalName") closeModal(modalName);
      if (key === "modalReply") closeModal(modalReply);
    });

    const loadReplies = async () => {
      if (repliesCache) return repliesCache;
      try{
        const res = await fetch("data/replies.json", { cache:"no-store" });
        if (!res.ok) { repliesCache = {}; return repliesCache; }
        repliesCache = await res.json();
        if (typeof repliesCache !== "object" || repliesCache === null) repliesCache = {};
        return repliesCache;
      }catch{
        repliesCache = {};
        return repliesCache;
      }
    };

    btnOpenLetter.addEventListener("click", () => openModal(modalLetter));

    btnOpenInbox.addEventListener("click", async () => {
      await loadReplies();
      nameInput.value = "";
      openModal(modalName);
      nameInput.focus({ preventScroll:true });
    });

    const tryOpenReply = async () => {
      const name = nameInput.value;
      if (!name) return;
      const data = await loadReplies();
      const msg = data[name];
      if (!msg) return;

      closeModal(modalName);
      replyTitle.textContent = `${name}님께`;
      replyBody.textContent = String(msg);
      openModal(modalReply);
    };

    btnCheckName.addEventListener("click", () => { void tryOpenReply(); });

    nameInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") void tryOpenReply();
    });
  </script>
</body>
</html>
